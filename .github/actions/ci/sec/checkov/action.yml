name: 'Checkov'
description: 'Execute Checkov' 

runs:  
  using: 'composite'
  steps:

    - name: Checkout
      uses: actions/checkout@v3 

    - name: Install Checkov 
      run: | 
        pip install checkov
      shell: bash

    - name: 'Run Checkov' 
      run: | 
        checkov -d . --framework terraform --quiet -o sarif --output-file checkov.sarif
      shell: bash 

    - name: Upload SARIF File
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: checkov.sarif